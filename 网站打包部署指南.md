# å’–å•¡åç‰‡ç¼–è¾‘å™¨ - ç½‘ç«™æ‰“åŒ…éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿæ‰“åŒ…

### æ–¹æ³•ä¸€ï¼šä¸€é”®æ‰“åŒ…ï¼ˆæ¨èï¼‰
```bash
# Windows
æ‰“åŒ….bat

# Linux/Mac
chmod +x æ‰“åŒ….sh
./æ‰“åŒ….sh
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ‰“åŒ…
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. è¿è¡Œæ‰“åŒ…è„šæœ¬
node package-simple.js
```

## ğŸ“¦ æ‰“åŒ…å†…å®¹

æ‰“åŒ…åçš„ `coffee-editor/` æ–‡ä»¶å¤¹åŒ…å«ï¼š

```
coffee-editor/
â”œâ”€â”€ index.html              # ä¸»é¡µé¢
â”œâ”€â”€ style.css               # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ script.js               # å‰ç«¯é€»è¾‘
â”œâ”€â”€ server.js               # åç«¯æœåŠ¡å™¨
â”œâ”€â”€ package.json            # é¡¹ç›®é…ç½®
â”œâ”€â”€ package-lock.json       # ä¾èµ–é”å®š
â”œâ”€â”€ config.js               # CDNé…ç½®æ–‡ä»¶
â””â”€â”€ å®å¡”éƒ¨ç½²è¯´æ˜.txt        # éƒ¨ç½²æŒ‡å—
```

## ğŸŒ éƒ¨ç½²æ–¹å¼

### 1. å®å¡”é¢æ¿éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### æ­¥éª¤ï¼š
1. **ä¸Šä¼ æ–‡ä»¶**
   - ç™»å½•å®å¡”é¢æ¿
   - è¿›å…¥"æ–‡ä»¶"ç®¡ç†
   - ä¸Šä¼  `coffee-editor` æ–‡ä»¶å¤¹åˆ°ç½‘ç«™ç›®å½•
   - è§£å‹åˆ°ç½‘ç«™æ ¹ç›®å½•

2. **å®‰è£…Node.js**
   - å®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº—
   - æœç´¢"Node.jsç‰ˆæœ¬ç®¡ç†å™¨"
   - å®‰è£… Node.js 16.x æˆ–æ›´é«˜ç‰ˆæœ¬

3. **å®‰è£…ä¾èµ–**
   - å®å¡”é¢æ¿ â†’ ç»ˆç«¯
   - è¿›å…¥ç½‘ç«™ç›®å½•ï¼š`cd /www/wwwroot/æ‚¨çš„åŸŸå/`
   - è¿è¡Œï¼š`npm install`

4. **å¯åŠ¨æœåŠ¡**
   - å®å¡”é¢æ¿ â†’ PM2ç®¡ç†å™¨
   - æ·»åŠ é¡¹ç›®ï¼š
     - åç§°ï¼š`coffee-editor`
     - å¯åŠ¨æ–‡ä»¶ï¼š`server.js`
     - ç«¯å£ï¼š`3000`
   - ç‚¹å‡»å¯åŠ¨

5. **è®¿é—®ç½‘ç«™**
   - åœ°å€ï¼š`http://æ‚¨çš„åŸŸå:3000`
   - æˆ–é…ç½®åå‘ä»£ç†åˆ°80ç«¯å£

#### å¸¸ç”¨PM2å‘½ä»¤ï¼š
```bash
# é‡å¯æœåŠ¡
pm2 restart coffee-editor

# æŸ¥çœ‹æ—¥å¿—
pm2 logs coffee-editor

# åœæ­¢æœåŠ¡
pm2 stop coffee-editor

# æŸ¥çœ‹çŠ¶æ€
pm2 status
```

### 2. äº‘æœåŠ¡å™¨éƒ¨ç½²

#### ç¯å¢ƒè¦æ±‚ï¼š
- Node.js 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- è‡³å°‘ 512MB å†…å­˜
- æ”¯æŒç«¯å£ 3000

#### éƒ¨ç½²æ­¥éª¤ï¼š
```bash
# 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
scp -r coffee-editor/ user@your-server:/var/www/

# 2. ç™»å½•æœåŠ¡å™¨
ssh user@your-server

# 3. è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/coffee-editor

# 4. å®‰è£…ä¾èµ–
npm install --production

# 5. å¯åŠ¨æœåŠ¡
npm start

# 6. ä½¿ç”¨PM2ç®¡ç†ï¼ˆæ¨èï¼‰
npm install -g pm2
pm2 start server.js --name coffee-editor
pm2 startup
pm2 save
```

### 3. Dockeréƒ¨ç½²

#### åˆ›å»º Dockerfileï¼š
```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --production

COPY . .

EXPOSE 3000

CMD ["npm", "start"]
```

#### æ„å»ºå’Œè¿è¡Œï¼š
```bash
# æ„å»ºé•œåƒ
docker build -t coffee-card-editor .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name coffee-card-editor \
  -p 3000:3000 \
  -v $(pwd)/img:/app/img \
  coffee-card-editor
```

### 4. é™æ€æ–‡ä»¶éƒ¨ç½²

#### ä¿®æ”¹ä¸ºé™æ€ç½‘ç«™ï¼š
```javascript
// ä¿®æ”¹ server.jsï¼Œæ·»åŠ é™æ€æ–‡ä»¶æœåŠ¡
app.use(express.static('public'));

// å°†å‰ç«¯æ–‡ä»¶ç§»åŠ¨åˆ° public ç›®å½•
// public/
//   â”œâ”€â”€ index.html
//   â”œâ”€â”€ style.css
//   â”œâ”€â”€ script.js
//   â””â”€â”€ config.js
```

#### CDNé…ç½®è¦æ±‚ï¼š
- ç³»ç»Ÿå®Œå…¨ä¾èµ–CDNè·å–å›¾ç‰‡
- éœ€è¦é…ç½®æ­£ç¡®çš„CDNåœ°å€åœ¨ config.js ä¸­
- ç¡®ä¿CDNæœåŠ¡å¯ç”¨ä¸”æ”¯æŒè·¨åŸŸè®¿é—®

#### éƒ¨ç½²åˆ°CDNï¼š
```bash
# é˜¿é‡Œäº‘OSS
ossutil cp -r ./public/ oss://your-bucket/coffee-card-editor/

# è…¾è®¯äº‘COS
coscmd upload -r ./public/ /coffee-card-editor/

# AWS S3
aws s3 sync ./public/ s3://your-bucket/coffee-card-editor/
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```bash
# åˆ›å»º .env æ–‡ä»¶
NODE_ENV=production
PORT=3000
LOG_DIR=/var/log/coffee-card-editor
```

### åå‘ä»£ç†é…ç½®ï¼ˆNginxï¼‰
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### SSLè¯ä¹¦é…ç½®
```bash
# ä½¿ç”¨ Let's Encrypt
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å¯ç”¨Gzipå‹ç¼©
```javascript
const compression = require('compression');
app.use(compression());
```

### 2. è®¾ç½®ç¼“å­˜å¤´
```javascript
app.use(express.static('public', {
    maxAge: '1d',
    etag: true
}));
```

### 3. ä½¿ç”¨CDN
- ç³»ç»Ÿå®Œå…¨ä¾èµ–CDNè·å–å›¾ç‰‡
- ä¿®æ”¹ `config.js` ä¸­çš„CDNé…ç½®
- ç¡®ä¿CDNæœåŠ¡å¯ç”¨ä¸”æ”¯æŒè·¨åŸŸè®¿é—®

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜ï¼š

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æŸ¥çœ‹ç«¯å£å ç”¨
   netstat -tulpn | grep :3000
   
   # æ€æ­»è¿›ç¨‹
   kill -9 PID
   ```

2. **CDNé…ç½®é—®é¢˜**
   ```bash
   # æ£€æŸ¥config.jsä¸­çš„CDNé…ç½®
   cat config.js
   
   # æµ‹è¯•CDNè¿æ¥
   curl -I https://your-cdn-domain.com/images.json
   ```

3. **å†…å­˜ä¸è¶³**
   ```bash
   # å¢åŠ äº¤æ¢ç©ºé—´
   sudo fallocate -l 1G /swapfile
   sudo chmod 600 /swapfile
   sudo mkswap /swapfile
   sudo swapon /swapfile
   ```

4. **PM2å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   pm2 logs coffee-editor --lines 100
   
   # é‡å¯PM2
   pm2 kill
   pm2 start server.js --name coffee-editor
   ```

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### 1. æ—¥å¿—ç®¡ç†
```bash
# è®¾ç½®æ—¥å¿—è½®è½¬
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
```

### 2. æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨
pm2 monit

# æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯
pm2 show coffee-editor
```

### 3. è‡ªåŠ¨å¤‡ä»½
```bash
# è®¾ç½®å®šæ—¶å¤‡ä»½
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
0 2 * * * tar -czf /backup/coffee-card-editor-$(date +\%Y\%m\%d).tar.gz /var/www/coffee-card-editor
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹**ï¼šç¡®ä¿æœåŠ¡ç¨³å®šè¿è¡Œ
2. **é…ç½®åå‘ä»£ç†**ï¼šéšè—ç«¯å£ï¼Œä½¿ç”¨æ ‡å‡†80/443ç«¯å£
3. **å¯ç”¨SSLè¯ä¹¦**ï¼šæä¾›HTTPSè®¿é—®
4. **å®šæœŸå¤‡ä»½**ï¼šé˜²æ­¢æ•°æ®ä¸¢å¤±
5. **ç›‘æ§æ—¥å¿—**ï¼šåŠæ—¶å‘ç°é—®é¢˜
6. **é…ç½®CDN**ï¼šç¡®ä¿å›¾ç‰‡åŠ è½½é€Ÿåº¦å’Œå¯ç”¨æ€§
7. **è®¾ç½®é˜²ç«å¢™**ï¼šåªå¼€æ”¾å¿…è¦ç«¯å£
8. **æµ‹è¯•CDNè¿æ¥**ï¼šç¡®ä¿CDNæœåŠ¡ç¨³å®šå¯ç”¨

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Node.jsç‰ˆæœ¬æ˜¯å¦å…¼å®¹
2. ç«¯å£3000æ˜¯å¦å¯ç”¨
3. CDNé…ç½®æ˜¯å¦æ­£ç¡®
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
5. ä¾èµ–æ˜¯å¦å®Œæ•´å®‰è£…
6. æœåŠ¡å™¨å†…å­˜æ˜¯å¦å……è¶³

---

**ç¥æ‚¨éƒ¨ç½²æˆåŠŸï¼** ğŸ‰
